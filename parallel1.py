# !pip install -q laserembeddings
# !python -m laserembeddings download-models

from datasets import load_dataset, Dataset
from laserembeddings import Laser
from sklearn.metrics.pairwise import cosine_similarity
from sklearn.preprocessing import normalize
import pandas as pd
import numpy as np
import polars as pl
import tldextract
from collections import defaultdict
import spacy


nlp_en = spacy.load("en_core_web_sm")
laser = Laser()

hr_dataset = load_dataset("clips/mfaq", "de")
en_dataset = load_dataset("clips/mfaq", "en")


en_hr = ['data4life', 'hotelvistabella', 'bitcoinrevolution', 'domburg', 'patterndesigns', 'printful', 'hoteldaniel', 'life-in-germany', 'lottery', 'hotelcasa', 'paintevents', 'icastelli', 'info-alberghi', 'vodafone', 'bitcoin-loophole', 'binzel-abicor', 'rentalcargroup', 'horizn-studios', 'cyberghostvpn', 'casinotopsonline', 'onlinecasinorank', 'laser-aesthetik-institut', 'asos', 'camaloon', 'apple', 'intercityhotel', 'voyage-prive', 'momondo', 'personio', 'msdmanuals', 'unumotors', 'lugaris', 'hg', 'busbud', 'neventum', 'apeaksoft', 'karlroadcc', 'kizi-mizi', 'halalbooking', 'pevgrow', 'cleverfiles', 'vpnetic', 'flowers4ljubljana', 'safetydetectives', 'bitrefill', 'invushop', 'datasite', 'loveplanet', 'wijkaanzee', 'tokopedia', 'sqoom', 'bora', 'kayak', 'bottlebase', 'airdropbob', 'ufpro', 'propain-bikes', 'hotellakehouse', 'cbs', 'instaon', 'zyro', 'charlies-names', 'arcomountainguide', 'flowers4bratislava', 'hotelweitzer', 'sojadis', 'reincubate', 'blackfriday', 'flexoffice', 'easyairportparking', '3dandprint', 'tutuapp-vip', 'trablisa', 'wellnesshome24', 'tripadvisor', 'sahasngo', 'hotels', 'creatopy', 'xohotels', 'itheorie', 'ebayfeescalculator', 'indiecampers', 'swiss', 'gvbbiopharma', 'logishotels', 'dishoek', '2miners', 'cobaeurope', 'wise', 'justbob', 'walteronline', 'zapptales', 'dolomiti', 'livedealers', 'ecocare', 'meininger-hotels', 'netcamcenter', 'aqsaup', 'westminster-abbey', 'topuniversities', 'siddhiyoga', 'slotsrank', 'ford', 'mandyskin', 'colad', 'flypgs', 'grandferdinand', 'coldjet', 'zankyou', 'stellarinfo', 'godominicanrepublic', 'heidelberg', 'mentalfoodchain', 'adobe', 'photobox', 'zoutelande', 'sumup', 'crowdstrike', 'workcamp', 'esky', 'register-lei', 'pacorabanne', 'paybis', 'bpost', 'newcasinos', 'noordwijk', 'toyota', 'roboyo', 'easyvoyage', 'helloprint', 'brandartery', 'leaseplan', 'websiteplanet', 'hetmanrecovery', 'casamundo', 'flowers4armenia', 'smilesecret', 'thonhotels', 'clicks', 'storytiles', 'radicalstorage', 'pitchup', 'emc4success', 'kaffeeform', '810popo', 'easy', 'casinodaemon', 'bitbucks', 'bonus-codes', 'endoca', 'crowdlitoken', 'tiffany', 'rayhaber', 'forex', 'suunto', 'sailica', 'casino', 'stasher', 'leap', 'adventures', 'cibdol', 'flowers4tenerife', 'lagona-divers', 'voiceovermaker', 'zandvoort', 'mind', 'culturecapsule', 'vpnmentor', 'canyon', 'gableinsurance', 'ticketmaster', 'one-versus-one', 'gornation', 'plus500', 'rentalcars', 'cookiefirst', 'global-coupon', 'nanoil', 'soleilvacances', 'koksijde', 'e-globalcoupon', 'nestpick', 'waterwipes', 'dr-kuehhas', 'casinorating', 'laprairie', 'compeed', 'rockypop-chamonix', 'autoeurope', 'vegasslotsonline', 'molenkoning', 'websitetooltester', 'artikelschreiber', 'zurich', 'oetztal', 'vintage-portfolio', 'netentcasino', 'marcelisler', 'jimdo', 'vohrawoundcare', 'availabill', 'guidetoiceland', 'free-spins', 'flowers4guatemala', 'sixt', 'nieuwvliet', 'hotelscombined', 'my-esthetic', 'moneycheck', 'liveagent', 'ontrack', 'eventbrite', 'globaltopcode', 'legohouse', 'coindataflow', 'polish-yacht-registration', 'purestorage', 'austrian', 'realchems', 'allianz', 'renesse', 'allfreecoupon', 'contabo', 'havlat', 'bose', 'casino-bonus', 'casinority', 'thetrainline', 'netigate', 'destinia', 'turna', 'johnnybet', 'fitflop', 'medorahotels', 'oem-parts', 'invezz', 'hardreset', 'turbomedia', 'ionos', 'luxembourg-city', 'simoptions', 'ship24', 'wein', 'bergenaanzee', 'escapecampervans', 'apptec360', 'airportinfo', 'netent', 'giromatch', 'cadzand', 'aalberts-st', 'supermonitoring', 'lentiamo', 'piprebate', 'likeminded', 'kissandfly', 'rockanje', 'fay', 'thelotter', 'usebounce', 'cybex-online', 'pumpkincareers', 'seyvillas', 'kreuzfahrten', 'shenyun', 'nonstopdogwear', 'stada', 'buy-bio', 'zamnesia', 'daenemarkheiraten', 'birkenstock', 'qualtrics', 'coya', 'livecasinorank', 'websitehostingrating', 'namesnack', 'whatsgaming', 'bitsabout', 'slots', 'forexsrovnavac', 'asktraders', 'skyscanner', 'otrium', 'snowthority', 'caxino', 'wheelz', 'keyence', 'etf', 'lvbet', 'anjapc', 'plastische-chirurgie-medienhafen', 'bestcomo', 'webhostingsecretrevealed', 'clickmeeting', 'bingj', 'autospain', 'spotify', 'fuertehoteles', 'e-consystems', 'verizonconnect', 'mediteo', 'thymio', 'thecouponsites', 'ameland', 'vipernews', '3dhubs', 'zavamed', 'casinosource', 'cryptoplaycasinos', 'symtrax', 'nikki', 'womensbest', 'ig', 'virtualrunners', 'couponsiteworld', 'lexisnexis', 'sensoryseeds', 'filecalendar', 'saleduck', 'bosch-diy', 'online-casinos', 'lolalykke', 'farecompare', 'higift', 'pixelplanet', 'hotelcondesa', 'eucerin', 'hometogo', 'bodyfast', 'wildz', 'hostinger', 'egmondaanzee', 'thinkspain', 'newyorkcity', 'hotel-heritage', 'paradrome', 'coursera', 'iqos', 'eskytravel', 'viator', 'bugaboo', 'gambledude', 'nannybag', 'slots4play', 'opentable', 'lastminute', 'yakki', 'parafiaruchocice', 'mac-downloader', 'bonuscodes', 'bjr-vacante', 'expedia', 'ivisa', 'crushingcasinos', 'couponnearme', 'bollenstreek', 'hosteurope', 'flightright', 'huehd', 'energycasino', 'klinkhammer', 'flowers4oslo', 'kingcom', 'casinoble', 'esl', 'etoro', 'hamburgcodingschool', 'hide', 'mrringo', 'getreadyforbrexit', 'trenes', 'nilfisk', '99designs', 'checkmybus', 'oostkapelle', 'drom', 'istockphoto', 'chronext', 'dancenter', 'tweak-box', 'mandmdirect', 'happyscribe', 'toolani', 'easytoys', 'blitzhandel24', 'autoprio', 'wiferion', 'camping-soelden', 'playacambrils', 'hytecon', 'elfsight', 'hurtigruten', 'adguard', 'ccm', 'radaar', 'toyota-forklifts', 'gambling', 'tink', 'tmamethod', 'megawaysslots', 'salzkammergut', 'livecasino24', 'ongadam', 'flowers4sanmarino', 'anycoindirect', 'texel', 'helvetia', 'virail', 'edreams', 'mapro', 'clubmedjobs', 'flowers4kuwait', 'terschelling', 'steigenberger', 'topmba', 'wanapix', 'trip', 'cookiebot', 'bariatricadvantage', 'nuvias', 'wanderu', 'hostelz', 'wizcase', 'amsterdam', 'barcelo', 'business-asset', 'clearblue', 'firma', 'leicertificate', 'slate-lite', 'holland', 'gambleonline', 'bliz', 'digikey', 'bwt', 'casinoviking', 'amberseaside', 'todaytourism', 'bookaway', 'transfeero', 'benevablack', 'scheveningen', 'cmcmarkets', 'thinkmobiles', 'flitz-events', 'weddybird', 'brunel', 'avatrade', 'zizzz', 'baunat', 'tickets-paris', 'jettransfer', 'rome2rio', 'mawista', 'tehnoezh', 'flowers4tianjin', 'karsan', 'erco', 'hardware-wallets', 'uber', 'soccerkinetics', 'flowers4costa-rica', 'ictrainer', 'dentaly', 'neoh', 'eltima', 'prodesigns', 'flowers4ibiza', 'geoln', 'lowdepositcasino', 'avast', 'hrs', 'thebridgetampa', 'mastermover', 'swordian', 'elho', 'maltepedentalclinic', 'awias', 'expediagroup', 'honda', 'flowers4lebanon', 'skiamade', 'etihad', 'zenmate', 'vidmateapp', 'luxplus', 'mrinsta', 'burghhaamstede']


en_fil_list = ['oem-parts.hu', 'kayak.co.uk', 'nikki.amsterdam', 'destinia.ch', 'endoca.com', 'ebayfeescalculator.com', 'medorahotels.com', 'momondo.co.uk', 'hotelscombined.com.au', 'tiffany.ca', 'lexisnexis.com', 'drom.ru', 'rayhaber.com', 'bosch-diy.com', 'tokopedia.com', 'luxplus.co.uk', '99designs.com.br', 'destinia.ma', 'casino.in', 'mrinsta.com', 'bonus-codes.com', 'happyscribe.co', 'binzel-abicor.com', 'expedia.be', 'opentable.jp', 'vodafone.com.au', 'nonstopdogwear.com', 'casino.online', 'virail.ca', 'bugaboo.com', 'cybex-online.com', 'fuertehoteles.com', 'horizn-studios.co.uk', 'sailica.com', 'opentable.com.au', 'fitflop.com', 'adventures.com', 'momondo.at', 'eventbrite.ie', 'safetydetectives.com', 'lowdepositcasino.com', 'tripadvisor.com.my', 'swiss.com', 'hotelcondesa.com', 'eskytravel.co.nz', 'skyscanner.com.my', 'sensoryseeds.com', 'paybis.com', 'casino-bonus.codes', 'slots4play.com', 'dishoek.com', 'bitbucks.io', 'lvbet.lv', 'tripadvisor.ie', 'coursera.org', 'rome2rio.com', '99designs.fr', 'dr-kuehhas.at', 'destinia.co.il', 'expediagroup.com', 'liveagent.de', 'ford.com', 'parafiaruchocice.pl', 'domburg.com', 'destinia.co.uk', 'momondo.co.nz', 'skyscanner.gg', '99designs.com', 'flowers4tianjin.com', 'destinia.kr', 'casinoble.co.za', 'airportinfo.live', 'chronext.com.au', 'flowers4guatemala.com', 'airdropbob.com', 'erco.com', 'hetmanrecovery.com', 'webhostingsecretrevealed.net', 'skyscanner.com.ph', 'rentalcargroup.com', 'eucerin.co.uk', 'emc4success.com', 'slotsrank.com', 'tripadvisor.se', 'datasite.com', 'global-coupon.org', 'ticketmaster.ie', 'blitzhandel24.co.uk', 'jettransfer.net', 'womensbest.com', 'unumotors.com', 'casinodaemon.com', '99designs.ca', 'momondo.ca', 'colad.co', 'casinoviking.com', '3dandprint.eu', 'tripadvisor.dk', 'bonuscodes.com', 'destinia.do', 'grandferdinand.com', '99designs.jp', 'tripadvisor.co.hu', 'destinia.lt', 'flowers4bratislava.com', 'toyota.com.cy', 'hotelscombined.com', 'hostinger.my', 'sumup.com', 'bitcoinrevolution.ai', 'expedia.ie', 'storytiles.nl', 'mawista.com', 'lottery.com', 'virtualrunners.org', 'kayak.pt', 'laser-aesthetik-institut.de', 'destinia.cat', 'tripadvisor.sk', 'purestorage.com', 'checkmybus.com', 'destinia.dk', 'lugaris.com', 'adobe.com', 'liveagent.com', 'horizn-studios.com', 'destinia.com.br', 'nestpick.com', 'momondo.se', 'virail.co.nz', 'tutuapp-vip.com', 'destinia.ie', 'eskytravel.co.za', 'hotelscombined.co.za', 'anjapc.org', 'avatrade.ca', 'wijkaanzee.net', 'simoptions.com', 'bose.ae', 'couponsiteworld.com', 'adguard.com', 'camping-soelden.com', 'expedia.co.nz', 'casinosource.ie', 'camaloon.co.uk', 'roboyo.de', 'esky.com.sg', 'destinia.co', 'expedia.co.in', 'slate-lite.com', 'pitchup.com', 'waterwipes.com', 'expedia.com.my', 'tripadvisor.com.ph', 'indiecampers.com', 'cookiebot.com', 'virail.in', 'skiamade.com', 'bliz.com', 'clicks.digital', 'momondo.cz', 'mrringo.com', 'chronext.com', 'esky.co.uk', 'tripadvisor.fi', 'wanapix.co.uk', 'kreuzfahrten.de', 'egmondaanzee.org', 'marcelisler.com', 'expedia.co.jp', 'clickmeeting.com', 'momondo.com.co', 'momondo.dk', 'destinia.fi', 'godominicanrepublic.com', 'kayak.com.au', 'livedealers.com', '99designs.be', 'pacorabanne.com', 'thinkmobiles.com', 'onlinecasinorank.co.za', 'usebounce.com', 'bose.my', 'hotelscombined.com.sg', 'plus500.co.za', 'kissandfly.com', 'virail.com', 'getreadyforbrexit.eu', 'destinia.us', 'mind.capital', 'lastminute.com', 'plus500.co.uk', 'hytecon.com', 'easyairportparking.de', 'ig.com', 'tripadvisor.co.kr', 'mandmdirect.ie', 'destinia.gt', 'gambledude.com', 'hotels.ng', 'zapptales.com', 'wiferion.com', 'namesnack.com', 'hotelscombined.co.nz', 'autoeurope.co.uk', 'bitrefill.com', 'hide.me', 'playacambrils.com', 'westminster-abbey.org', 'hg.eu', 'pixelplanet.com', 'bookaway.com', 'expedia.com.au', 'prodesigns.com', 'baunat.com', 'tripadvisor.ca', 'ticketmaster.co.nz', 'casinoble.org', 'contabo.com', 'cmcmarkets.com', '99designs.co.uk', 'destinia.com.tr', 'hostinger.co.uk', 'hotelscombined.ie', 'tiffany.ie', 'kayak.com', 'eltima.com', 'skyscanner.com.sg', 'eucerin.ca', 'voiceovermaker.io', 'culturecapsule.org', 'kayak.co.th', 'e-globalcoupon.org', 'vpnmentor.com', 'ontrack.com', 'globaltopcode.com', 'cleverfiles.com', 'energycasino.com', 'tripadvisor.ch', 'fay.com', 'coya.com', 'hurtigruten.com', 'tripadvisor.com.tw', 'eucerin.com', 'toyota-forklifts.com.mt', 'online-casinos.com', 'thonhotels.com', 'casino.xyz', 'invushop.com', 'bollenstreek.nl', 'opentable.co.uk', 'tripadvisor.co.nz', 'instaon.io', 'gableinsurance.li', 'toyota-forklifts.cz', 'destinia.sk', 'crowdstrike.co.uk', 'realchems.com', 'hotelscombined.co.uk', 'ivisa.com', 'destinia.hu', 'cibdol.com', 'steigenberger.com', 'one-versus-one.com', 'tweak-box.com', 'livecasinorank.ca', 'casamundo.co.uk', 'toyota-forklifts.eu', 'lolalykke.com', 'onlinecasinorank.co.uk', 'virail.co.uk', 'destinia.lv', 'polish-yacht-registration.com', 'daenemarkheiraten.de', 'walteronline.com', 'etoro.com.cn', 'esky.com.ng', 'thetrainline.com', 'patterndesigns.com', 'destinia.de', 'skyscanner.co.id', 'destinia.uy', 'hotels.cn', 'topuniversities.com', 'momondo.pl', 'apple.com', 'wildz.com', 'helvetia.com', 'wheelz.com', 'gornation.com', 'leaseplan.com', 'esky.com.my', 'edreams.com', 'msdmanuals.com', 'birkenstock.com', 'kingcom.ch', 'mandyskin.com', 'thelotter.com.au', 'yakki.net', 'casinosource.co.nz', 'opentable.hk', 'charlies-names.com', 'artikelschreiber.com', 'holland.com', 'nuvias.com', 'crowdlitoken.com', 'toyota.co.uk', 'kayak.pl', 'tiffany.co.uk', 'topmba.com', 'wanderu.com', 'gambleonline.co', 'momondo.kz', 'nieuwvliet.org', 'austrian.com', 'kayak.sa', 'momondo.co.za', 'forex.fi', 'destinia.cr', 'flowers4sanmarino.com', 'livecasino24.com', 'itheorie.ch', 'likeminded.care', 'momondo.com.pe', 'compeed.co.uk', 'virail.com.au', 'halalbooking.com', 'websiteplanet.com', 'hosteurope.de', 'thinkspain.com', 'digikey.ch', 'destinia.ae', 'maltepedentalclinic.com', 'opentable.sg', 'avatrade.ru', 'esky.com.eg', 'hardreset.info', 'destinia.com', 'destinia.com.ua', 'rockypop-chamonix.com', 'bose.com', 'otrium.nl', 'buy-bio.eu', 'elho.com', 'istockphoto.com', 'verizonconnect.com', 'ecocare.com.au', 'thelotter.com', 'momondo.com', 'hoteldaniel.com', 'legohouse.com', 'eucerin.co.za', 'etihad.com', 'tehnoezh.ua', 'avatrade.com.au', 'netcamcenter.com', 'destinia.pl', 'photobox.co.nz', 'hotelscombined.in', 'websitetooltester.com', 'onlinecasinorank.co.nz', 'ecocare.center', 'bose.id', 'roboyo.us', 'hostinger.com', 'apeaksoft.com', '2miners.com', 'reincubate.com', 'kayak.co.in', 'ionos.ca', 'voyage-prive.co.uk', 'karlroadcc.org', 'momondo.by', 'crushingcasinos.com', 'availabill.ch', 'destinia.ly', 'happyscribe.com', 'vintage-portfolio.com', 'neoh.com', 'flowers4ljubljana.com', 'opentable.co.th', 'ford.ca', '99designs.hk', 'tripadvisor.rs', 'edreams.co.uk', 'casino.guru', 'etf.lt', 'saleduck.com.my', 'karsan.com', 'skyscanner.ie', 'coldjet.com', 'zizzz.ch', 'etoro.com', 'esky.co.ke', 'soccerkinetics.de', 'crowdstrike.com', 'photobox.ie', 'tripadvisor.co.id', 'plus500.com', 'bose.sg', 'elfsight.com', 'skyscanner.co.il', 'esky.ie', 'transfeero.com', 'destinia.is', 'tripadvisor.in', 'smilesecret.com', 'expedia.ca', 'avatrade.ng', 'guidetoiceland.is', 'photobox.com.au', 'hotelcasa.nl', 'easyvoyage.co.uk', 'personio.com', 'paradrome.de', 'momondo.ru', 'honda.co.nz', 'renesse.com', 'bose.ie', 'eventbrite.com', 'jimdo.com', 'aalberts-st.com', 'nilfisk.com', 'lvbet.com', 'esky.eu', 'checkmybus.co.uk', 'terschelling.org', 'plus500.com.au', 'casinoble.co.nz', 'destinia.jp', 'autoeurope.ca', 'eventbrite.hk', 'neventum.com', 'thebridgetampa.org', 'expedia.co.id', 'expedia.com.hk', 'netigate.net', 'nanoil.co.uk', 'edreams.net', 'vohrawoundcare.com', 'opentable.com', 'todaytourism.com', 'geoln.com', 'edreams.in', 'flightright.co.uk', 'momondo.cl', 'kayak.ie', 'toolani.com', 'esky.com', 'sahasngo.org', 'wizcase.com', 'skyscanner.co.nz', 'qualtrics.com', 'momondo.ie', 'moneycheck.com', 'newcasinos.com', 'zyro.com', 'momondo.tw', 'weddybird.com', 'dolomiti.it', 'casinoble.in', 'asos.com', 'kayak.com.ph', 'kayak.sg', 'toyota-forklifts.ie', 'creatopy.com', 'oetztal.com', 'tripadvisor.com', 'opentable.ca', 'destinia.com.eg', 'cobaeurope.com', 'megawaysslots.com', 'destinia.pt', 'momondo.com.tr', 'destinia.cn', 'flowers4costa-rica.com', 'thymio.org', 'vodafone.in', 'havlat.de', 'forexsrovnavac.cz', 'bariatricadvantage.eu', 'arcomountainguide.com', 'casinotopsonline.com', 'sixt.com', 'casinosource.co.uk', 'tripadvisor.com.au', 'seyvillas.com', 'easy.poker', 'destinia.sg', 'icastelli.net', 'bose.ca', 'casamundo.com', 'johnnybet.com', 'websitehostingrating.com', 'e-consystems.com', 'zurich.ch', 'brandartery.com', 'aqsaup.org', 'mastermover.com', 'eucerin.my', 'tripadvisor.com.gr', 'lentiamo.co.uk', 'giromatch.com', 'spotify.com', 'rockanje.org', 'expedia.com.ph', 'easytoys.uk', 'mapro.si', 'zamnesia.com', 'blackfriday.ch', 'momondo.fr', 'destinia.ad', 'cadzand.org', 'destinia.ec', 'casino.buzz', 'destinia.com.ar', 'viator.com', 'allianz.com.au', 'kayak.com.my', 'nanoil.ie', 'hotelscombined.ca', 'destinia.ru', 'anycoindirect.eu', 'amberseaside.com', 'destinia.in', 'hotel-heritage.com', 'camaloon.com', 'gvbbiopharma.com', 'autoeurope.com', 'destinia.com.au', 'autoeurope.com.au', 'koksijde.com', 'momondo.fi', 'momondo.com.au', 'printful.com', 'momondo.it', 'ameland.de', 'bergenaanzee.org', 'opentable.de', 'wein.plus', 'texel.de', 'dancenter.com', 'destinia.at', 'thecouponsites.com', 'destinia.fr', 'life-in-germany.de', 'edreams.com.au', 'momondo.nl', 'momondo.pt', 'hardware-wallets.net', 'tripadvisor.com.hk', 'vegasslotsonline.com', 'avatrade.com', 'netent.com', 'tripadvisor.com.sg', 'my-esthetic.com', 'siddhiyoga.com', 'onlinecasinorank.ca', 'gambling.com', 'farecompare.com', 'sumup.ie', 'heidelberg.com', 'tink.us', 'symtrax.com', 'justbob.shop', 'nannybag.com', 'casinorating.com', 'esl.co.uk', 'cookiefirst.com', 'tripadvisor.co.za', 'hometogo.com.au', 'zenmate.com', 'iqos.com', 'noordwijk.org', 'stasher.com', 'plus500.com.sg', 'hotels.com', 'dentaly.org', 'leap.us', 'newyorkcity.ca', 'leicertificate.org', '99designs.ie', 'destinia.sa', 'opentable.com.mx', 'uber.com', 'casino.org', 'onlinecasinorank.org', 'vidmateapp.com', 'data4life.care', 'asktraders.com', 'hotelscombined.ae', 'trip.com', 'destinia.asia', 'flexoffice.swiss', 'plastische-chirurgie-medienhafen.de', 'kayak.com.hk', 'supermonitoring.com', 'awias.com', 'avast.com', 'adventures.is', 'wellnesshome24.de', 'ccm.net', 'cbs.de', 'bitcoin-loophole.io', 'destinia.qa', 'digikey.de', 'workcamp.ch', 'paintevents.ch', '3dhubs.com', 'laprairie.com', 'couponnearme.com', 'eucerin.sg', 'tickets-paris.fr', 'flightright.com', 'netentcasino.com', 'mediteo.com', 'hostinger.dk', 'digikey.sg', 'suunto.com', 'radaar.io', 'mandmdirect.com', 'skyscanner.ca', 'avatrade.co.za', 'business-asset.com', 'wise.com', 'indiecampers.ie', 'zankyou.com.au', 'digikey.hk', 'hostinger.jp', 'amsterdam.org', 'ufpro.com', 'destinia.tw', 'klinkhammer.com', '99designs.com.au', 'firma.de', 'pumpkincareers.com', 'expedia.com', 'stada.com', 'huehd.com', 'cyberghostvpn.com', 'tripadvisor.com.ve', 'zandvoort.biz', 'ionos.com', 'momondo.ee', 'hostinger.se', 'sixt.co.uk', 'momondo.ch', 'casinority.com', 'radicalstorage.com', 'whatsgaming.net', 'flowers4armenia.com', 'bingj.com', 'bose.co.uk', 'casinosource.ca', 'logishotels.com', 'bpost.be', 'intercityhotel.com', 'stellarinfo.com', 'skyscanner.ae', 'hostinger.in', 'coindataflow.com', 'destinia.it', 'hotelvistabella.com', 'oostkapelle.net', 'hrs.com', 'mac-downloader.com', 'loveplanet.ru', 'expedia.co.uk', 'vpnetic.com', 'ongadam.org', 'tmamethod.com', 'momondo.mx', 'mentalfoodchain.com', 'skyscanner.net', 'hometogo.co.uk', 'apptec360.com', 'opentable.ae', 'kissandfly.ng', 'busbud.com', 'clearblue.com', 'clubmedjobs.com', 'turna.com', 'destinia.be', 'ionos.co.uk', 'zavamed.com', 'flowers4tenerife.com', 'slots.lv', 'eucerin.ua', 'flowers4oslo.com', 'hamburgcodingschool.com', 'bora.com', 'propain-bikes.com', 'pevgrow.com', 'sumup.co.uk', 'sqoom.com', 'kizi-mizi.com', 'hurtigruten.co.uk', '99designs.com.mx', 'bodyfast.de', 'ticketmaster.com.au', 'expedia.com.tw', 'scheveningen.com', 'destinia.co.za', 'turbomedia.io', 'flitz-events.com', 'filecalendar.com', 'tripadvisor.com.vn', 'ship24.com', 'autoprio.com', 'benevablack.ch', 'destinia.mx', 'ticketmaster.co.uk', 'opentable.ie', 'kayak.co.id', 'bose.hk', '810popo.net', 'meininger-hotels.com', '99designs.ch', 'destinia.se', 'eventbrite.com.au', 'keyence.com', 'avatrade.co.uk', 'shenyun.com', 'escapecampervans.com', 'zoutelande.info', 'momondo.com.br', '99designs.at', 'brunel.net', 'rentalcars.com', 'skyscanner.co.in', 'register-lei.co.uk', 'snowthority.com', 'invezz.com', 'ictrainer.com', 'tiffany.com', 'flowers4kuwait.com', 'skyscanner.com', 'momondo.ro', 'xohotels.com', 'hostelz.com', 'tripadvisor.cz', 'cryptoplaycasinos.com', 'expedia.com.sg', 'bose.co.nz', 'momondo.es', '99designs.nl', 'bwt.com', 'momondo.in', 'hometogo.com', 'lagona-divers.com', 'toyota-forklifts.no', 'vipernews.com', 'bestcomo.com', 'helloprint.co.uk', 'virail.ie', 'salzkammergut.at', 'higift.eu', 'kaffeeform.com', 'livecasinorank.co.uk', 'skyscanner.com.hk', 'flowers4lebanon.net', 'tripadvisor.co.uk', 'destinia.cz', 'hotelscombined.com.ph', 'skyscanner.com.au', 'photobox.co.uk', 'trablisa.es', 'plus500.co.nz', 'hotellakehouse.com', 'trenes.com', 'destinia.net.br', 'bitsabout.me', 'free-spins.net', 'virail.sg', 'momondo.de', 'virail.my', 'burghhaamstede.com', 'destinia.nl', 'luxembourg-city.com', 'expedia.co.th', 'soleilvacances.com', 'flypgs.com', 'canyon.com', 'destinia.gr', 'bose.com.au', 'wellnesshome24.com', 'bose.co.th', 'skyscanner.ch', 'crowdstrike.de', 'kayak.ae', 'allfreecoupon.org', 'tiffany.com.au', 'sojadis.com', 'caxino.com', 'barcelo.com', 'autospain.co.uk', 'piprebate.com', 'esky.com.hk', 'hotelweitzer.com', 'molenkoning.com']

en_filtered = en_dataset['train'].filter(lambda example: example['domain'] in en_fil_list)

hr_fil_list = ['oem-parts.hu', 'bjr-vacante.ro', 'nikki.amsterdam', 'endoca.com', 'ebayfeescalculator.com', 'medorahotels.com', 'saleduck.ch', 'saleduck.at', 'drom.ru', 'casinoble.eu', 'rayhaber.com', 'bosch-diy.com', 'mrinsta.com', 'bonus-codes.com', 'binzel-abicor.com', 'bose.at', 'nonstopdogwear.com', 'casino.online', 'bugaboo.com', 'cybex-online.com', 'fuertehoteles.com', 'sailica.com', 'fitflop.com', 'tripadvisor.at', 'momondo.at', 'adventures.com', 'safetydetectives.com', 'lowdepositcasino.com', 'swiss.com', 'hotelcondesa.com', 'casinosource.at', 'paybis.com', 'casino-bonus.codes', 'slots4play.com', 'dishoek.com', 'forex.de', 'eventbrite.at', 'dr-kuehhas.at', 'rome2rio.com', 'expediagroup.com', 'liveagent.de', 'parafiaruchocice.pl', 'domburg.com', 'compeed.at', 'airportinfo.live', 'airdropbob.com', 'erco.com', 'hetmanrecovery.com', 'webhostingsecretrevealed.net', 'rentalcargroup.com', 'emc4success.com', 'datasite.com', 'global-coupon.org', 'jettransfer.net', 'womensbest.com', 'unumotors.com', 'roboyo.ch', 'casinoviking.com', 'colad.co', '3dandprint.eu', 'bonuscodes.com', 'grandferdinand.com', 'toyota.de', 'checkmybus.de', 'sumup.com', 'ionos.de', 'bitcoinrevolution.ai', 'storytiles.nl', 'lottery.com', 'mawista.com', 'hrs.de', 'laser-aesthetik-institut.de', 'purestorage.com', 'tripadvisor.de', 'lugaris.com', 'nestpick.com', 'adobe.com', 'horizn-studios.com', 'tutuapp-vip.com', 'anjapc.org', 'molenkoning.com', 'wijkaanzee.net', 'hardware-wallets.de', 'simoptions.com', 'couponsiteworld.com', 'blitzhandel24.ch', 'camping-soelden.com', 'adguard.com', 'easyvoyage.de', 'slate-lite.com', 'roboyo.de', 'pitchup.com', 'waterwipes.com', 'cookiebot.com', 'skiamade.com', 'clicks.digital', 'netcamcenter.de', 'flightright.at', 'mrringo.com', 'photobox.de', 'kreuzfahrten.de', 'egmondaanzee.org', 'marcelisler.com', 'clickmeeting.com', 'helloprint.de', 'godominicanrepublic.com', 'livedealers.com', 'pacorabanne.com', 'brunel.at', 'bitbucks.de', 'thinkmobiles.com', 'usebounce.com', 'getreadyforbrexit.eu', 'mind.capital', 'vodafone.de', 'hytecon.com', 'easyairportparking.de', 'expedia.de', 'ig.com', 'hotelscombined.at', 'hometogo.ch', 'gambledude.com', 'zapptales.com', 'wiferion.com', 'tiffany.de', 'bitrefill.com', 'hide.me', 'livecasinorank.at', 'register-lei.at', 'playacambrils.com', 'westminster-abbey.org', 'hg.eu', 'zankyou.at', 'pixelplanet.com', 'smilesecret.de', 'bookaway.com', 'skyscanner.de', 'prodesigns.com', 'baunat.com', 'tripadvisor.ca', 'casino.at', 'contabo.com', 'cmcmarkets.com', 'kayak.com', 'eltima.com', 'flowers4ibiza.com', 'voiceovermaker.io', 'culturecapsule.org', 'e-globalcoupon.org', 'vpnmentor.com', 'ontrack.com', 'globaltopcode.com', 'cleverfiles.com', 'energycasino.com', 'tripadvisor.ch', 'fay.com', 'coya.com', 'ford.de', 'tripadvisor.com.br', 'skyscanner.at', 'thonhotels.com', 'invushop.com', 'bollenstreek.nl', 'plus500.li', 'instaon.io', 'casinodaemon.de', 'gableinsurance.li', 'realchems.com', 'allianz.ch', 'kissandfly.at', 'ivisa.com', 'one-versus-one.com', 'steigenberger.com', 'tweak-box.com', 'ictrainer.de', 'kissandfly.de', 'lolalykke.com', 'polish-yacht-registration.com', 'daenemarkheiraten.de', 'hotelscombined.ch', 'walteronline.com', 'thetrainline.com', 'esky.at', 'patterndesigns.com', 'eventbrite.de', 'topuniversities.com', 'newyorkcity.de', 'helvetia.com', 'apple.com', 'wildz.com', 'wheelz.com', 'gornation.com', 'leaseplan.com', 'msdmanuals.com', 'birkenstock.com', 'kingcom.ch', 'kayak.ch', 'mandyskin.com', 'casinoble.ch', 'yakki.net', 'bose.de', 'charlies-names.com', 'artikelschreiber.com', 'nuvias.com', 'holland.com', 'crowdlitoken.com', 'topmba.com', 'wanderu.com', 'gambleonline.co', 'nieuwvliet.org', 'austrian.com', 'livecasino24.com', 'edreams.ch', 'itheorie.ch', 'likeminded.care', 'halalbooking.com', 'websiteplanet.com', 'hosteurope.de', 'thinkspain.com', 'maltepedentalclinic.com', 'opentable.sg', 'casino-bonus.de', 'hardreset.info', 'destinia.com', 'rockypop-chamonix.com', 'bose.com', 'otrium.nl', 'buy-bio.eu', 'elho.com', 'istockphoto.com', 'verizonconnect.com', 'thelotter.com', 'hoteldaniel.com', 'legohouse.com', 'etihad.com', 'tehnoezh.ua', 'personio.de', 'flightright.de', 'expedia.at', 'websitetooltester.com', 'eskytravel.ch', 'casinosource.ch', 'ecocare.center', 'onlinecasinorank.de', 'apeaksoft.com', '2miners.com', 'tink.at', 'reincubate.com', 'karlroadcc.org', 'crushingcasinos.com', 'hostinger.de', 'availabill.ch', 'happyscribe.com', 'vintage-portfolio.com', 'neoh.com', 'flowers4ljubljana.com', 'kayak.de', 'moneycheck.de', 'casino.guru', 'karsan.com', 'coldjet.com', 'slots.express', 'zizzz.ch', 'etoro.com', 'autoeurope.de', 'soccerkinetics.de', 'voyage-prive.de', 'plus500.com', 'elfsight.com', 'virtualrunners.de', 'transfeero.com', 'etf.at', 'guidetoiceland.is', 'hotelcasa.nl', 'luxplus.com', 'eucerin.ch', 'paradrome.de', 'autoprio.de', 'renesse.com', 'lexisnexis.de', 'photobox.ch', 'aalberts-st.com', 'jimdo.com', 'ticketmaster.de', 'sixt.ch', 'nilfisk.com', 'lvbet.com', 'easytoys.at', 'terschelling.org', 'thebridgetampa.org', 'casinoble.xyz', 'supermonitoring.de', 'netigate.net', 'blitzhandel24.at', 'digikey.it', 'vohrawoundcare.com', 'cibdol.de', 'geoln.com', 'zizzz.de', 'keyence.de', 'lastminute.de', 'toolani.com', 'sahasngo.org', 'wizcase.com', 'qualtrics.com', 'plus500.de', 'newcasinos.com', 'neventum.de', 'tink.de', 'zyro.com', 'hometogo.at', 'weddybird.com', 'dolomiti.it', 'asos.com', 'kayak.sg', 'creatopy.com', 'oetztal.com', 'info-alberghi.com', 'cobaeurope.com', 'sensoryseeds.de', 'autospain.de', 'megawaysslots.com', 'thymio.org', 'havlat.de', 'forexsrovnavac.cz', 'bariatricadvantage.eu', 'arcomountainguide.com', 'casinotopsonline.com', 'seyvillas.com', 'icastelli.net', 'johnnybet.com', 'sumup.de', 'checkmybus.ch', 'wanapix.de', 'toyota-forklifts.ch', 'websitehostingrating.com', 'honda.at', 'e-consystems.com', 'bose.ch', 'zurich.ch', 'brandartery.com', 'aqsaup.org', 'mastermover.com', 'giromatch.com', 'spotify.com', 'rockanje.org', 'mapro.si', 'blackfriday.ch', 'zamnesia.com', 'cadzand.org', 'viator.com', 'ionos.at', 'onlinecasinorank.at', 'eucerin.at', 'mandmdirect.de', 'anycoindirect.eu', '99designs.de', 'amberseaside.com', 'hotel-heritage.com', 'gvbbiopharma.com', 'koksijde.com', 'printful.com', 'ameland.de', 'texel.de', 'bergenaanzee.org', 'opentable.de', 'wein.plus', 'hurtigruten.ch', 'virail.be', 'zankyou.de', 'thecouponsites.com', 'life-in-germany.de', 'camaloon.de', 'checkmybus.at', 'vegasslotsonline.com', 'netent.com', 'my-esthetic.com', 'siddhiyoga.com', 'farecompare.com', 'gambling.com', 'heidelberg.com', 'symtrax.com', 'nanoil.de', 'nannybag.com', 'cookiefirst.com', 'casinorating.com', 'tripadvisor.co.za', 'zenmate.com', 'virail.de', 'iqos.com', 'nanoil.ch', 'noordwijk.org', 'hotels.com', 'dentaly.org', 'sumup.at', 'esl.de', 'leicertificate.org', 'uber.com', 'expedia.ch', 'vidmateapp.com', 'data4life.care', 'asktraders.com', 'plus500.at', 'trip.com', 'flexoffice.swiss', 'plastische-chirurgie-medienhafen.de', 'awias.com', 'leap.de', 'avast.com', 'dancenter.de', 'adventures.is', 'wellnesshome24.de', 'ccm.net', 'cbs.de', 'lentiamo.ch', 'bitcoin-loophole.io', 'hotelscombined.de', 'digikey.de', 'workcamp.ch', 'paintevents.ch', '3dhubs.com', 'laprairie.com', 'couponnearme.com', 'tickets-paris.fr', 'netentcasino.com', 'mediteo.com', 'eskytravel.de', 'suunto.com', 'radaar.io', 'business-asset.com', 'wise.com', 'amsterdam.org', 'ufpro.com', 'livecasinorank.de', 'klinkhammer.com', 'kizi-mizi.de', 'firma.de', 'pumpkincareers.com', 'stada.com', 'huehd.com', 'cyberghostvpn.com', 'zandvoort.biz', 'zankyou.ch', 'momondo.ch', 'casinority.com', 'radicalstorage.com', 'whatsgaming.net', 'stellarinfo.com', 'bingj.com', 'logishotels.com', 'bpost.be', 'intercityhotel.com', 'flitz-events.de', 'coindataflow.com', 'hotelvistabella.com', 'oostkapelle.net', 'mac-downloader.com', 'loveplanet.ru', 'vpnetic.com', 'ongadam.org', 'tmamethod.com', 'swordian.com', 'mentalfoodchain.com', 'toyota-forklifts.de', 'apptec360.com', 'blitzhandel24.de', 'clubmedjobs.com', 'clearblue.com', 'busbud.com', 'easy.eu', 'easytoys.de', 'turna.com', 'zavamed.com', 'flowers4tenerife.com', 'hamburgcodingschool.com', 'bora.com', 'indiecampers.de', 'propain-bikes.com', 'online-casinos.ch', 'pevgrow.com', 'chronext.at', 'sqoom.com', 'bodyfast.de', 'scheveningen.com', 'turbomedia.io', 'filecalendar.com', 'bottlebase.com', 'ship24.com', 'benevablack.ch', '810popo.net', 'meininger-hotels.com', '99designs.ch', 'shenyun.com', 'escapecampervans.com', 'zoutelande.info', '99designs.at', 'rentalcars.com', 'snowthority.com', 'invezz.com', 'avatrade.de', 'xohotels.com', 'hostelz.com', 'cryptoplaycasinos.com', 'justbob.de', 'bwt.com', 'lagona-divers.com', 'vipernews.com', 'salzkammergut.at', 'higift.eu', 'kaffeeform.com', 'casamundo.de', 'chronext.de', 'trablisa.es', 'hotellakehouse.com', 'trenes.com', 'edreams.de', 'bitsabout.me', 'hometogo.de', 'free-spins.net', 'momondo.de', 'burghhaamstede.com', 'luxembourg-city.com', 'flypgs.com', 'canyon.com', 'skyscanner.ch', 'allfreecoupon.org', 'crowdstrike.de', 'slotsrank.de', 'sojadis.com', 'barcelo.com', 'caxino.com', 'piprebate.com', 'hotelweitzer.com', 'stasher.com']

hr_filtered = hr_dataset['train'].filter(lambda example: example['domain'] in hr_fil_list)

def extract_root_domain(domain_url):
    return tldextract.extract(domain_url).domain

def check_items_in_sentence(sentence, items):
    return all(item in sentence for item in items)

arr_en = pl.from_arrow(en_filtered.data.table)
arr_hr = pl.from_arrow(hr_filtered.data.table)

aligned_sentences = []
for d in en_hr:
  en_sentences = []
  en_answers = []
  hr_sentences = []
  hr_answers = []
  hr_ids = []
  hr_doms = []
  
  en_dataset_filtered = en_filtered.filter(lambda example: extract_root_domain(example['domain']) == d, batch_size=50000)
  hr_dataset_filtered = hr_filtered.filter(lambda example: extract_root_domain(example['domain']) == d)

  en_sentences = [pair["question"] for page in en_dataset_filtered for pair in page["qa_pairs"]]
  en_answers = [pair["answer"] for page in en_dataset_filtered for pair in page["qa_pairs"]]
  hr_sentences = [pair["question"] for page in hr_dataset_filtered for pair in page["qa_pairs"]]
  hr_answers = [pair["answer"] for page in hr_dataset_filtered for pair in page["qa_pairs"]]
  hr_doms = [page["domain"] for page in hr_dataset_filtered for pair in page["qa_pairs"]]
  hr_ids = [page["id"] for page in hr_dataset_filtered for pair in page["qa_pairs"]]
  
  en_embeddings = laser.embed_sentences(en_sentences, lang='en')
  hr_embeddings = laser.embed_sentences(hr_sentences, lang='de')
  en_embeddings = normalize(en_embeddings, norm='l2')
  hr_embeddings = normalize(hr_embeddings, norm='l2')

  # Compute cosine similarities between English and Croatian sentence embeddings
  similarities = cosine_similarity(en_embeddings, hr_embeddings)

  # Set the similarity threshold
  similarity_threshold = 0.8

  # Find the index of the most similar Croatian sentence for each English sentence
  most_similar_indices = similarities.argmax(axis=1)
  for i in range(len(en_sentences)):
        above_threshold_q = np.where(similarities[i] >= similarity_threshold)[0]
        for j in above_threshold_q:
            ner = []
            doc = nlp_en(en_sentences[i])
            ner = [ent.text for ent in doc.ents if ent.label_ in ['GPE','ORG', 'LOC']]
            numbers = [token.text for token in doc if token.like_num]  # Extract specific numbers

            if check_items_in_sentence(hr_sentences[j], ner) and check_items_in_sentence(hr_sentences[j], numbers):
              en_a = laser.embed_sentences(en_answers[i], lang='en')
              hr_a = laser.embed_sentences(hr_answers[j], lang='de')
              en_a = normalize(en_a, norm='l2')
              hr_a = normalize(hr_a, norm='l2')

              answer_similarity = cosine_similarity(en_a, hr_a)
              aggr = (answer_similarity[0][0]*0.6)+(similarities[i,j]*0.4)
              # Check if the similarity score of the corresponding answers is also above the threshold
              #if answer_similarity[0][0] >= 0.9 or (answer_similarity[0][0] >= 0.8 and similarities[i,j] >= 0.9):
              if aggr >=0.84 or (answer_similarity >= 0.8 and similarities[i,j] >= 0.9):
                aligned_sentences.append((hr_ids[j], hr_doms[j], en_sentences[i], en_answers[i], similarities[i,j], hr_sentences[j], hr_answers[j], answer_similarity[0][0]))

df = pd.DataFrame(aligned_sentences, columns=['id','domain', 'question','answer'])
df['qa_pairs'] = df.apply(lambda row: [{'question': row['question'], 'answer': row['answer']}], axis=1)
# group by A and B, and combine the dictionaries in CD
df_grouped = df.groupby(['id', 'domain'])['qa_pairs'].apply(sum).reset_index()
df_grouped.head()
para_data = Dataset.from_pandas(df_grouped)
para_data = para_data.train_test_split(test_size=0.1)
para_data.save_to_disk('en_de_parallel')